<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:models="clr-namespace:ChessDB.Models"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="ChessDB.MainWindow"
        Title="ChessDB"
        Closing="Window_Closing">

    <DockPanel>
        <TextBlock Text="PO3L - ChessDB" 
                   FontSize="24" FontWeight="Bold" 
                   DockPanel.Dock="Top" Margin="10" 
                   HorizontalAlignment="Center"/>

        <TabControl Margin="5">
            
            <TabItem Header="Gestion Joueurs">
                <Grid ColumnDefinitions="*, 300">
                    <DockPanel Grid.Column="0" Margin="10">
                        <TextBlock Text="Liste des Joueurs" FontSize="18" FontWeight="Bold" DockPanel.Dock="Top" Margin="0,0,0,10"/>

                        <TextBox x:Name="RechercherUnJoueur" Watermark="ðŸ” Rechercher un joueur" KeyUp="RechercherJoueur" Width="200" HorizontalAlignment="Left" DockPanel.Dock="Top" Margin="0,0,0,15"/>

                        <ListBox x:Name="ListeJoueurs">
                            <ListBox.ItemTemplate>
                                <DataTemplate x:DataType="models:Joueur">

                                    <Grid ColumnDefinitions="*,Auto,Auto">
                                        
                                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Nom}" FontWeight="Bold"/>
                                            <TextBlock Text="{Binding Prenom}"/>
                                            <TextBlock Text="{Binding Elo, StringFormat='({0} Elo)'}"/>
                                            <TextBlock Text="{Binding Email}" FontStyle="Italic"/>
                                        </StackPanel>

                                        <Button Grid.Column="1"
                                            Content="âœŽ"
                                            Background="Transparent"
                                            Foreground="Blue"
                                            BorderThickness="0"
                                            Padding="10,5"
                                            Tag="{Binding}"
                                            Click="BoutonEditerJoueur"/>

                                        <Button Grid.Column="2"
                                                Content="ðŸ—‘"
                                                Background="Transparent"
                                                Foreground="Red"
                                                BorderThickness="0"
                                                Padding="10,5"
                                                Tag="{Binding}" 
                                                Click="BoutonSupprimerJoueur"/>
                                                
                                    </Grid>

                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </DockPanel>
                    
                    <Border Grid.Column="1" Background="#e6f7ff" Margin="10" Padding="10" CornerRadius="5">
                        <StackPanel Spacing="10">
                            <TextBlock x:Name="TitreJoueur" Text="Nouveau Joueur" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                            <TextBlock Text="Nom :"/>
                            <TextBox x:Name="InputNom" Watermark="Ex: Chouaa"/>
                            <TextBlock Text="PrÃ©nom :"/>
                            <TextBox x:Name="InputPrenom" Watermark="Ex: Mohamed"/>
                            <TextBlock Text="Email :"/>
                            <TextBox x:Name="InputEmail" Watermark="Ex : 23105@ecam.be"/>
                            <TextBlock Text="Elo :"/>
                            <TextBox x:Name="InputElo" Watermark="Par dÃ©faut : 1200"/>
                            <Button x:Name="TitreBoutonJoueur"
                                    Content="Ajouter Joueur" 
                                    Click="BoutonJoueur" 
                                    HorizontalAlignment="Stretch" 
                                    Margin="0,20,0,0"/>
                        </StackPanel>
                    </Border>

                </Grid>
            </TabItem>

            <TabItem Header="CompÃ©titions">
                <Grid ColumnDefinitions="*, 300">
                    
                    <DockPanel Grid.Column="0" Margin="10">
                        <TextBlock Text="Tournois en cours" FontSize="18" FontWeight="Bold" DockPanel.Dock="Top" Margin="0,0,0,10"/>
                        
                        <ListBox x:Name="ListeCompetitions" SelectionChanged="SelectionTournoi">
                            <ListBox.ItemTemplate>
                                <DataTemplate x:DataType="models:Competition">
                                    
                                    <Grid ColumnDefinitions="*,Auto,Auto">

                                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding ID, StringFormat='NÂ°\{0\}'}" FontWeight="Bold" Width="40"/>
                                            <TextBlock Text="{Binding Nom}"/>
                                        </StackPanel>

                                        <Button Grid.Column="1" 
                                            Content="âœŽ"
                                            Background="Transparent" 
                                            Foreground="DarkBlue"
                                            BorderThickness="0"
                                            Tag="{Binding}"
                                            Click="BoutonEditerTournoi"/>

                                        <Button Grid.Column="2" 
                                                Content="ðŸ—‘"
                                                Background="Transparent"
                                                Foreground="Red"
                                                BorderThickness="0"
                                                Padding="10,5"
                                                Tag="{Binding}"
                                                Click="BoutonSupprimerTournoi"/>

                                    </Grid>

                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </DockPanel>

                    <Grid Grid.Column="1" RowDefinitions="Auto, *" Margin="10">
                        
                        <Border Grid.Row="0" Background="#e6f7ff" Margin="0,0,0,20" Padding="10" CornerRadius="5">
                            <StackPanel Spacing="10">
                                <TextBlock x:Name="TitreTournoi" Text="Nouveau Tournoi" FontSize="16" FontWeight="Bold"/>
                                <TextBox x:Name="InputNomTournoi" Watermark="Nom du tournoi..."/>
                                <Button x:Name="TitreBoutonTournoi" Content="CrÃ©er" Click="BoutonTournoi" HorizontalAlignment="Stretch"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Row="1" x:Name="ZoneGestion" IsVisible="False"
                                BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Padding="10">
                            
                            <StackPanel Spacing="10">
                                <TextBlock Text="GÃ‰RER LE TOURNOI" FontWeight="Bold"/>
                                
                                <Viewbox Stretch="Uniform" StretchDirection="DownOnly" MaxHeight="80" HorizontalAlignment="Stretch">
                                        <TextBlock x:Name="TxtTitreTournoi" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Foreground="DarkGreen"/>
                                </Viewbox>
                                
                                <Separator/>

                                <TextBlock Text="Ajouter un joueur :"/>
                                <ComboBox x:Name="ComboJoueursDispo" 
                                        HorizontalAlignment="Stretch" 
                                        PlaceholderText="-- Choisir un joueur --">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate x:DataType="models:Joueur">
                                            <TextBlock Text="{Binding Nom}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>

                                <Button Content="Inscrire" Click="BoutonInscrire" HorizontalAlignment="Stretch"/>

                                <Separator/>
                                <TextBlock Text="Inscrits :" FontWeight="Bold"/>
                                
                                <ListBox x:Name="ListeInscrits" Height="150">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate x:DataType="models:Joueur">
                                            <TextBlock Text="{Binding Nom}"/>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>

                            </StackPanel>
                        </Border>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Gestion Matchs">
                <Grid ColumnDefinitions="300, *, *" Margin = "10">
                    
                    <DockPanel Grid.Column="0" Margin="0,0,10,0">
                        <TextBlock Text="Choisir un tournoi" FontSize="18" FontWeight="Bold" DockPanel.Dock="Top" Margin="0,0,0,10"/>
                        
                        <ListBox x:Name="ListeCompetitionsMatchs" SelectionChanged="SelectionTournoiMatch" ScrollViewer.HorizontalScrollBarVisibility="Auto">
                            <ListBox.ItemTemplate>
                                <DataTemplate x:DataType="models:Competition">
                                    <StackPanel Orientation="Horizontal" Spacing="10">
                                        <TextBlock Text="{Binding Nom}" FontWeight="Bold"/>
                                        <TextBlock Text="{Binding Matchs.Count, StringFormat='({0} matchs)'}" FontStyle="Italic"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </DockPanel>

                    <Grid Grid.Column="1" x:Name="ZoneMatchs" IsVisible="False" RowDefinitions="Auto, *" Margin="10,0,10,0">
                        
                        <StackPanel Grid.Row="0" Spacing="10" Margin="0,0,0,10">
                            <Viewbox Stretch="Uniform" StretchDirection="DownOnly" MaxHeight="80" HorizontalAlignment="Stretch">
                                <TextBlock x:Name="TxtTitreMatchs" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </Viewbox>
                            
                            <Button Content="CrÃ©er / RÃ©initialiser les matchs" 
                                    Click="BoutonLancerTournoi" 
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Background="#ffcccc"/>
                        </StackPanel>

                        <ListBox Grid.Row="1" x:Name="ListeMatchs" SelectionChanged="SelectionMatch" Background="White" BorderBrush="Gray" BorderThickness="1">
                            <ListBox.ItemTemplate>
                                <DataTemplate x:DataType="models:Match">
                                    <Grid ColumnDefinitions="30, *, 40, *, Auto">
                                        <TextBlock Grid.Column="0" Text="{Binding ID, StringFormat='M{0}'}" FontWeight="Bold" Foreground="Gray" VerticalAlignment="Center"/>
                                        
                                        <TextBlock Grid.Column="1" Text="{Binding Joueur1.Nom}" FontWeight="Bold" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                        
                                        <TextBlock Grid.Column="2" Text="VS" Foreground="DarkRed" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        
                                        <TextBlock Grid.Column="3" Text="{Binding Joueur2.Nom}" FontWeight="Bold" HorizontalAlignment="Left" VerticalAlignment="Center"/>

                                        <TextBlock Grid.Column="4" Text="{Binding ResultatAffiche}" Foreground="DarkBlue" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        
                    </Grid>
                    
                    <Border Grid.Column="2" x:Name="ZoneDetailsMatch" IsVisible="False"
                            BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Padding="15" Background="#f9f9f9">

                        <StackPanel Spacing="15">
                            <TextBlock Text="Arbitrage" FontSize="20" FontWeight="Bold" Foreground="DarkRed" HorizontalAlignment="Center"/>
                            
                            <TextBlock x:Name="TxtAfficheMatch"
                                    x:DataType="models:Match" 
                                    HorizontalAlignment="Center" 
                                    FontWeight="Bold" 
                                    FontSize="18"
                                    Margin="0,0,0,10">
                                
                                <Run Text="{Binding Joueur1.Nom}"/>
                                <Run Text=" VS "/>
                                <Run Text="{Binding Joueur2.Nom}"/>
                                
                            </TextBlock>
                            
                            <Separator/>

                            <TextBlock Text="Feuille de match (Coups) :" Margin="0,10,0,0"/>
                            <TextBox x:Name="InputCoups" x:DataType="models:Match" Text="{Binding Coups}" Height="150" AcceptsReturn="True" TextWrapping="Wrap" Watermark="Ex : 1. e4 e5 &#x0a;2. Cf3..."/>

                            <Separator/>

                            <TextBlock Text="RÃ©sultat final :" FontWeight="Bold" Margin="0,10,0,0"/>
                            
                            <Grid ColumnDefinitions="*,*,*">
                                <Button Content="Blanc 1-0" Click="BoutonResultat" Tag="1" Grid.Column="0" Margin="2" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Background="White" BorderBrush="Gray"/>
                                <Button Content="Nul Â½-Â½"   Click="BoutonResultat" Tag="X" Grid.Column="1" Margin="2" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Background="LightGray"/>
                                <Button Content="Noir 0-1"  Click="BoutonResultat" Tag="2" Grid.Column="2" Margin="2" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Background="Black" Foreground="White"/>
                            </Grid>

                        </StackPanel>
                    </Border>

                </Grid>
            </TabItem>

        </TabControl>
    </DockPanel>

</Window>